# Быстрый старт для команды - Idea-to-Post Pipeline v2

**Тип документа:** Обучающее руководство
**Дата:** 30 января 2026
**Версия:** 1.0
**Статус:** Готово к распространению

---

## Что изменилось в v2?

### 3 новых CSV-столбца в posts_content.csv

Теперь можно отслеживать историю публикаций и варианты контента:

```
НОВЫЕ СТОЛБЦЫ:
├─ last_posted_date    Дата последней публикации
├─ variant_of          Ссылка на исходный пост (для вариантов)
├─ content_type        Тип контента: demo/evergreen/topical
└─ repost_count        Количество переопубликаций
```

**Зачем это нужно:**
- Отслеживать эффективность контента по датам
- Создавать варианты одного поста для разных платформ
- Управлять демонстрационным контентом отдельно

---

### 1 новый JSON-файл: workflow_state.json

Временное хранилище данных при создании контента.

```
ЖИЗНЕННЫЙ ЦИКЛ:
c-03b2 (генерация) → создается workflow_state.json
   ↓
c-03c (черновики) → обновляется с draft_variants
   ↓
c-03d (улучшения) → обновляется с improvements
   ↓
c-03e (финализация) → сохраняется в CSV и УДАЛЯЕТСЯ
```

**Зачем это нужно:**
- Хранить предложения и черновики между шагами
- Позволить пользователю выбрать лучший вариант
- Удаляется автоматически (временный файл)

---

### 1 новый CSV-файл: offer_filter.csv

Личные предпочтения для генерации предложений.

```
МЕСТО: user_preferences/offer_filter.csv

СОДЕРЖИТ:
├─ training   Готовы ли генерировать: 1-on-1 коучинг?
├─ setup      Готовы ли генерировать: настройка процессов?
├─ templates  Готовы ли генерировать: готовые шаблоны?
├─ consulting Готовы ли генерировать: консультирование?
└─ full_dev   Готовы ли генерировать: полная разработка?
```

**Зачем это нужно:**
- Фильтровать предложения по вашим возможностям
- Не генерировать предложения, которые вы не можете предоставить
- Всегда под контролем - меняется редко

---

### 1 новый JSON-столбец: pain_points_json

Точки боли клиентов по каждому углу исследования.

```
ФОРМАТ:
{
  "angle_1": [
    "Боль 1 по первому углу",
    "Боль 2 по первому углу",
    "Боль 3 по первому углу"
  ],
  "angle_2": [
    "Боль 1 по второму углу",
    ...
  ]
}

ЗАПОЛНЯЕТСЯ: во время c-02c (исследование)
ИСПОЛЬЗУЕТСЯ: в c-03b2 (генерация предложений)
```

**Зачем это нужно:**
- Генерировать релевантные предложения
- Связывать предложения с конкретными болями
- Делать контент более целевым

---

## Что нужно делать по-другому

### Когда добавляете новую идею (c-01)

**Раньше:** Всё как обычно
**Теперь:** Всё как обычно

Ничего не меняется. Добавьте идею в `ideas_inbox.csv` как раньше.

---

### Когда исследуете идею (c-02c)

**Раньше:** Заполняли основные поля
**Теперь:** Нужно заполнить `pain_points_json`

```python
# Пример: добавить точки боли в ideas_research.csv

import json
import csv

# Читаем текущие данные
with open('data/ideas_research.csv') as f:
    rows = list(csv.DictReader(f))

# Обновляем последнюю строку (с новой идеей)
last_row = rows[-1]
last_row['pain_points_json'] = json.dumps({
    "angle_1": [
        "Точка боли 1",
        "Точка боли 2",
        "Точка боли 3"
    ],
    "angle_2": [
        "Точка боли 1",
        "Точка боли 2"
    ]
}, ensure_ascii=False)

# Сохраняем обратно
fieldnames = list(rows[0].keys())
with open('data/ideas_research.csv', 'w', newline='', encoding='utf-8') as f:
    writer = csv.DictWriter(f, fieldnames=fieldnames)
    writer.writeheader()
    writer.writerows(rows)
```

**Что произойдет:** c-03b2 будет использовать эти точки боли для генерации предложений.

---

### Когда создаёте контент (c-03)

**Раньше:** 3 шага (c-03b1 → c-03c → c-03e)
**Теперь:** до 5 шагов (c-03b1 → c-03b2 → c-03c → c-03d → c-03e)

#### Новый шаг c-03b2: Генерация предложений

```
ВЫ: Выбираете идею и угол (c-03b1)
     ↓
СИСТЕМА: Генерирует предложения (c-03b2)
         Входит в workflow_state.json
     ↓
ВЫ: Просматриваете предложения и выбираете
     ↓
СИСТЕМА: Переходит к c-03c
```

**Что происходит за кулисами:**
1. Система читает `pain_points_json` из ideas_research.csv
2. Система читает `offer_filter.csv` (ваши предпочтения)
3. Система генерирует предложения, которые:
   - Решают указанные боли
   - Соответствуют вашим предпочтениям
4. Предложения сохраняются в `workflow_state.json`

#### Новый шаг c-03b2 (демо-режим): ВСЕ возможные предложения

Если `content_type="demo"`, система генерирует:
- Несколько вариантов каждого типа предложения
- Предложения для каждого угла
- Все возможные варианты

**Зачем это нужно:** Показать команде и клиентам полный спектр возможностей.

#### Обновленный шаг c-03c: Создание черновиков

**Раньше:** Вы создаёте черновик вручную
**Теперь:** Система создаёт несколько вариантов черновиков

```
СИСТЕМА: Генерирует варианты черновиков
         для каждого предложения
     ↓
ВЫ: Просматриваете варианты
     Выбираете лучший (selected: true)
     ↓
СИСТЕМА: Переходит к c-03d
```

**Что происходит:**
1. Для каждого предложения создается 1-3 варианта черновика
2. Варианты имеют разные hooks и angles
3. Все сохраняются в `workflow_state.json`

#### Новый шаг c-03d (опционально): Улучшения

```
ВЫ: Просматриваете выбранные черновики
     Предлагаете улучшения
     ↓
СИСТЕМА: Применяет улучшения
         Обновляет workflow_state.json
     ↓
ВЫ: Проверяете результаты
```

#### Обновленный шаг c-03e: Финализация

**Раньше:** Вы вводили черновик вручную в posts_content.csv
**Теперь:** Система автоматически сохраняет

```
ВЫ: Выбираете лучший вариант (selected: true)
     ↓
СИСТЕМА: Сохраняет в posts_content.csv
         Заполняет новые столбцы:
         - last_posted_date
         - variant_of (если это вариант)
         - content_type
         - repost_count
         ↓
СИСТЕМА: Удаляет workflow_state.json
```

**Что происходит:**
1. Выбранный черновик сохраняется в `posts_content.csv`
2. Новые столбцы заполняются автоматически
3. `workflow_state.json` удаляется (больше не нужен)

---

### Когда публикуете контент

**Раньше:** Копировали title, body, cta вручную
**Теперь:** Всё готово в posts_content.csv

Все нужные поля уже заполнены:
```
├─ title              Заголовок (из черновика)
├─ body               Текст (из черновика)
├─ hook               Привлекающий крючок
├─ cta                Призыв к действию
├─ last_posted_date   Дата публикации
├─ content_type       Тип контента (demo/evergreen/topical)
└─ quality_score      Оценка качества
```

**Что нужно сделать:** Просто скопировать и опубликовать.

---

### Когда переопубликуете контент

**Раньше:** Создавали новую строку вручную
**Теперь:** Можно использовать `variant_of`

```python
# Пример: создать вариант существующего поста

import csv
from datetime import datetime

# Читаем существующий пост
with open('data/posts_content.csv') as f:
    rows = list(csv.DictReader(f))

original_post = rows[-1]  # Последний пост

# Создаём вариант
variant = original_post.copy()
variant['id'] = str(int(original_post['id']) + 1)
variant['title'] = 'Новый заголовок'
variant['body'] = 'Новый текст'
variant['hook'] = 'Новый крючок'
variant['created_date'] = datetime.now().strftime('%Y-%m-%d')
variant['last_posted_date'] = ''  # Будет заполнено при публикации
variant['variant_of'] = original_post['id']  # Ссылка на исходный
variant['repost_count'] = '0'  # Новый вариант

# Добавляем
rows.append(variant)

# Сохраняем
fieldnames = list(rows[0].keys())
with open('data/posts_content.csv', 'w', newline='', encoding='utf-8') as f:
    writer = csv.DictWriter(f, fieldnames=fieldnames)
    writer.writeheader()
    writer.writerows(rows)
```

**Зачем это нужно:** Отслеживать иерархию вариантов и их эффективность.

---

## Проверочный список для команды

### Перед началом работы

- [ ] Прочитан "Что изменилось в v2?"
- [ ] Понято где находится `workflow_state.json`
- [ ] Понято где находится `offer_filter.csv`
- [ ] Понято что такое `pain_points_json`

### Когда добавляете идею

- [ ] Используете обычный процесс (ничего не изменилось)
- [ ] Идея добавлена в `ideas_inbox.csv`

### Когда исследуете идею

- [ ] Заполнили `pain_points_json` с 3-5 болями по 2-3 углам
- [ ] JSON синтаксис правильный (можно проверить в Python)
- [ ] Данные сохранены в `ideas_research.csv`

### Когда создаёте контент

- [ ] Выбрали идею и угол (c-03b1)
- [ ] Просмотрели предложения (c-03b2)
- [ ] Выбрали предложение
- [ ] Просмотрели черновики (c-03c)
- [ ] Выбрали лучший черновик (selected: true)
- [ ] Финализировали (c-03e)
- [ ] Проверили что:
  - Пост в `posts_content.csv`
  - `workflow_state.json` удален
  - Новые столбцы заполнены

### Когда переопубликуете контент

- [ ] Установлена ссылка в `variant_of`
- [ ] Изменены нужные поля
- [ ] Сохранено в `posts_content.csv`

---

## Частые вопросы

**В: Где найти workflow_state.json?**
О: Файл находится в `.bmad/workflow_state.json`. Создается в c-03b2, удаляется в c-03e.

**В: Могу ли я редактировать offer_filter.csv?**
О: Да! Отредактируйте любое значение willing (0 или 1) и сохраните. Изменения будут применены при следующей генерации предложений.

**В: Что если pain_points_json содержит ошибку?**
О: Исправьте JSON синтаксис. Проверьте в Python: `json.loads(value)`. Должна работать без ошибок.

**В: Могу ли я создать вариант черновика вручную?**
О: Да! Скопируйте выбранный черновик в c-03c, отредактируйте и создайте новый пост с `variant_of`.

**В: Что произойдет если я удалю workflow_state.json?**
О: Вы потеряете текущий прогресс в c-03b2-c-03d. Начните заново с c-03b1.

**В: Какие значения для content_type?**
О: demo, evergreen, topical, tutorial. Используется для фильтрации и отслеживания.

---

## Контакты поддержки

**Вопрос по использованию?**
→ Посмотрите TROUBLESHOOTING-GUIDE.md

**Ошибка в коде?**
→ Посмотрите DATA-FLOW-DIAGRAM.md

**Как тестировать изменения?**
→ Посмотрите TESTING-GUIDE.md

**Техническая документация?**
→ Посмотрите CSV-SCHEMA-DOCUMENTATION.md или JSON-WORKFLOW-STATE-DOCUMENTATION.md

---

## Чек-лист в конце дня

```
☐ Все новые идеи добавлены
☐ Все исследования завершены с pain_points_json
☐ Все контент создан и сохранён
☐ Нет файлов workflow_state.json в .bmad
☐ Все new_posts в posts_content.csv заполнены полностью
```

---

**Быстрый старт завершен**
**Дата:** 30 января 2026
**Версия:** 1.0
**Статус:** ✅ Готово к распространению в команде
