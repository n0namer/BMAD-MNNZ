---
name: 'step-04.5-triz-analysis'
description: 'TRIZ-анализ противоречий: опциональный шаг, вызываемый из Step 4, 5 или 8'
mode: create
type: optional
estimatedTime: '5-120 минут (зависит от режима)'
requires:
  - workflow-plan.md (должен существовать)
  - Минимум одно выявленное противоречие
outputs:
  - contradiction-resolution.md
  - Обновлённый workflow-plan.md с TRIZ-решением
calledFrom:
  - step-04-consilium
  - step-05-scoring
  - step-08-deep-plan
templates:
  quick: '../templates/triz-quick.template.md'
  structured: '../templates/triz-structured.template.md'
  ariz: '../templates/ariz-full.template.md'
dataRef: '../data/triz-quick-patterns.md'
workflowPlanFile: '{bmb_creations_output_folder}/life-os/workflow-plan-life-os.md'
---

# Шаг 4.5: TRIZ-анализ противоречий (опциональный)

## ЦЕЛЬ ШАГА:

Разрешить противоречия, блокирующие прогресс, с помощью принципов ТРИЗ. Найти решение, которое снимает противоречие, а не компромисс.

## ОБЯЗАТЕЛЬНЫЕ ПРАВИЛА ИСПОЛНЕНИЯ:

### Универсальные правила:
- НИКОГДА не генерировать контент без ввода пользователя
- ПРОЧИТАТЬ полный файл шага перед выполнением действий
- ВЫ ФАСИЛИТАТОР, а не генератор контента
- ВСЕГДА говорить на языке `{communication_language}` из конфига

### Правила шага:
- Этот шаг вызывается ТОЛЬКО из других шагов (4, 5, 8)
- ВСЕГДА возвращать управление вызывающему шагу после завершения
- Документировать ВСЕ результаты в workflow-plan.md
- Сохранять в память для повторного использования

## КОГДА ИСПОЛЬЗОВАТЬ:

| Ситуация | Источник | Пример |
|----------|----------|--------|
| Эксперты сильно расходятся (>40% расхождение) | Шаг 4 (Консилиум) | "3 из 5 экспертов против выбранного подхода" |
| Критерии конфликтуют при скоринге | Шаг 5 (Скоринг) | "Высокий Impact + Высокий Effort одновременно" |
| Обнаружен trade-off при планировании | Шаг 8 (Deep Plan) | "Скорость vs Качество, Бюджет vs Фичи" |
| Пользователь явно выбрал [T] TRIZ | Любой шаг | Выбор из меню |

**Обязательные предусловия:**
- Противоречие идентифицировано (X конфликтует с Y)
- Workflow plan существует с контекстом проекта
- Файл данных доступен: `data/triz-quick-patterns.md`

---

## СЕКЦИЯ 1: Определение контекста

**Спросить у пользователя:**

1. "Откуда вы пришли?"
   - [4] Шаг 4: Консилиум (разногласия экспертов)
   - [5] Шаг 5: Скоринг (конфликт критериев)
   - [8] Шаг 8: Deep Plan (trade-off при планировании)

2. "В чём противоречие?"
   - Формат: "Нам нужно X, но X вызывает проблему Y"
   - Пример: "Нам нужна быстрая поставка (6 недель), но скорость снижает качество"

**Зафиксировать контекст в рабочих заметках перед продолжением.**

---

## СЕКЦИЯ 2: Дерево выбора режима

### Автоматическая рекомендация

```
Доступное время?
  |
  +-- <15 минут ---------> QUICK (быстрый паттерн)
  |
  +-- 15-60 минут
  |     |
  |     +-- Простое противоречие ---------> QUICK
  |     +-- Сложное / стратегическое -----> STRUCTURED
  |
  +-- >60 минут
        |
        +-- Средняя сложность ------------> STRUCTURED
        +-- Фундаментальное противоречие -> FULL ARIZ
```

### Таблица режимов

| Режим | Время | Для чего | Шаблон | Выход |
|-------|-------|----------|--------|-------|
| **Quick** | 5-10 мин | Быстрые решения, простые противоречия | `triz-quick.template.md` | 2-3 принципа + мозговой штурм |
| **Structured** | 30-60 мин | Важные проекты, сложные противоречия | `triz-structured.template.md` | Матрица + ИКР + детальный план |
| **Full ARIZ** | 2-4 часа | Стратегические проекты, фундаментальные | `ariz-full.template.md` | Полный 9-частный документ АРИЗ-85В |

### Рекомендация по контексту вызова:

- **Из Шага 4 (Консилиум):** Quick или Structured (зависит от уровня разногласий)
- **Из Шага 5 (Скоринг):** Structured (влияет на ключевое решение)
- **Из Шага 8 (Deep Plan):** Quick или Structured (Full ARIZ только если проект стратегический)

**Спросить:** "Какой режим? [Q] Quick  [S] Structured  [F] Full ARIZ"

---

## СЕКЦИЯ 3: Выполнение выбранного режима

### Режим 1: Quick (5-10 мин)

1. **Классифицировать противоречие** (используя `data/triz-quick-patterns.md`):
   - **Техническое:** Улучшение X ухудшает Y
   - **Физическое:** Один объект требует противоположных свойств
   - **Административное:** Кажется невозможным из-за ограничений

2. **Предложить топ-3 принципа** на основе типа противоречия из triz-quick-patterns.md

3. **Мозговой штурм:** Для каждого принципа спросить: "Как {Принцип} может разрешить это противоречие?" Пользователь даёт 1-2 идеи на принцип.

4. **Выбрать и задокументировать:** Пользователь выбирает 1-2 лучших решения. Создать `contradiction-resolution.md` по шаблону `triz-quick.template.md`.

5. **Вернуться** к вызывающему шагу.

---

### Режим 2: Structured (30-60 мин)

1. **Определить техническое противоречие:** Улучшаемый параметр vs Ухудшаемый параметр

2. **Матрица противоречий:** Найти ячейку пересечения в матрице 10x10 из triz-quick-patterns.md. Матрица предложит 2-4 принципа.

3. **Определить физическое противоречие** (если применимо): Объект нуждается в противоположных состояниях.

4. **Сформулировать ИКР (Идеальный Конечный Результат):**
   - Что мы хотим (результат)
   - Без чего (нежелательные побочные эффекты)
   - Само по себе (без дополнительных ресурсов)

5. **Применить принципы:** Для каждого принципа из матрицы прочитать определение и примеры, применить к текущему противоречию, документировать 2-3 конкретных решения.

6. **Оценить решения** по матрице (ИКР %, реализуемость, стоимость, время, риск).

7. **Задокументировать** по шаблону `triz-structured.template.md` и вернуться.

---

### Режим 3: Full ARIZ (2-4 часа)

1. **Создать документ** `ariz-full-analysis.md` по шаблону `ariz-full.template.md`.

2. **Выполнить 9 частей АРИЗ-85В:**
   - Часть 1: Анализ задачи (мини-задача, макси-задача, ИКР-1)
   - Часть 2: Анализ модели задачи (оперативная зона, время, ВПР)
   - Часть 3: Информационный анализ (патенты, аналоги, трансфер знаний)
   - Часть 4: Использование ВПР (пустое пространство, время, поля)
   - Часть 5: Применение базы знаний (76 стандартных решений)
   - Часть 6: Изменение/замена задачи (переформулировка, инверсия)
   - Часть 7: Анализ переходов системы (би-система, макро/микро-уровень)
   - Часть 8: Снятие психологической инерции (фантазии, ограничения)
   - Часть 9: Организация решения (выбор лучшего, проверка против ИКР)

3. **Провести пользователя через все части**, запрашивая ввод на каждом шаге.

4. **Создать исполнительное резюме** для workflow-plan.md.

5. **Интеграция с Deep Plan** (если из Шага 8): АРИЗ-решение становится L2-структурой, 9 частей маппятся на L3-L4.

---

## СЕКЦИЯ 4: Инструкции интеграции по вызывающим шагам

### Возврат в Шаг 4 (Консилиум)

- Представить TRIZ-решение экспертам консилиума
- Задать вопрос: "Снимает ли это решение ваши разногласия?"
- Измерить новый % консенсуса (ожидание: >80%)
- Обновить секцию "Consilium Recommendations" в workflow-plan.md
- Если консенсус улучшился <20% -- рассмотреть эскалацию в Structured или Full ARIZ

### Возврат в Шаг 5 (Скоринг)

- Пересчитать MCDA с TRIZ-скорректированным подходом
- Ожидать улучшение оценок (особенно Confidence, Risk)
- Обновить решение Stage Gate при изменении
- Документировать улучшение оценок в workflow-plan.md

### Возврат в Шаг 8 (Deep Plan)

- Интегрировать TRIZ-решение в L2-структуру
- Пример: "L2: Сегментация -- MVP-фаза + Фаза качества (Принцип 1)"
- Маппить фазы реализации на L3-L4
- Документировать до/после разрешения противоречия
- Обновить критерии Quality Gate

---

## СЕКЦИЯ 5: Формат вывода для workflow-plan.md

Добавить в workflow-plan.md:

```markdown
## TRIZ: Разрешение противоречия

**Дата:** {дата}
**Режим:** {Quick / Structured / Full ARIZ}
**Вызван из:** Шаг {4/5/8}

**Противоречие:**
- Улучшаемое: {X}
- Ухудшаемое: {Y}

**Решение:** {краткое описание}
**Принципы ТРИЗ:** {N1} - {Название}, {N2} - {Название}
**ИКР достижение:** {%}

**План реализации:**
- {пункт 1}
- {пункт 2}

**Критерии успеха:**
- {метрика 1}: цель = {значение}
- {метрика 2}: цель = {значение}

**Статус противоречия:** {Разрешено / Частично / Не разрешено}
```

---

## СЕКЦИЯ 6: Сохранение в память

**Автосохранение через CLI (глобальная память):**

```bash
npx claude-flow@v3alpha memory store \
  --namespace "shared-knowledge" \
  --key "life-os:methods:triz:{project_id}:{date}" \
  --content "{
    mode: '{Quick|Structured|Full}',
    contradiction: '{описание}',
    principles_used: ['{P1}', '{P2}'],
    solution: '{резюме}',
    effectiveness: '{оценка 1-5}',
    project_domain: '{Business|Finance|Health|Personal}',
    ifr_achievement: '{%}',
    called_from: 'step-{4|5|8}'
  }"
```

**Результат сохранения:**
- Будущие проекты найдут уже разрешённые аналогичные противоречия
- Паттерны повторного использования между доменами
- Обучение: какие принципы работают лучше для каких типов противоречий

---

## СЕКЦИЯ 7: Возврат к основному воркфлоу

**Показать меню возврата:**

```
TRIZ-анализ завершён.

Решение: {резюме}
Противоречие разрешено: {Да / Частично / Нет}

Далее:
[R] Вернуться в Шаг {X} (откуда пришли)
[4] Повторить Консилиум с TRIZ-решением
[5] Пересчитать Скоринг с новыми критериями
[8] Продолжить Deep Plan с TRIZ-структурой
```

**Обработать выбор и маршрутизировать обратно к соответствующему шагу.**

---

## МЕТРИКИ УСПЕХА

### Критерии завершения (все обязательны):
- Противоречие чётко определено
- Минимум 1 принцип ТРИЗ применён
- Конкретное решение задокументировано (не только теория)
- Решение записано в workflow-plan.md
- Память сохранена для будущего использования

### Проверка качества:
- Решение действительно разрешает противоречие? (не компромисс!)
- Решение реализуемо с доступными ресурсами?
- ИКР направляет решение (приближение к идеалу)?

### Антипаттерны (избегать):
- **Плохо:** "Сделаем среднюю скорость и среднее качество" (компромисс)
- **Хорошо:** "Фаза 1: быстрый MVP + Фаза 2: доводка качества" (разрешение через Принцип 1: Сегментация)

---

## СИСТЕМНЫЕ МЕТРИКИ

### УСПЕХ:
- Противоречие идентифицировано и классифицировано
- Режим выбран осознанно (по дереву решений)
- Решение задокументировано и подтверждено пользователем
- Результаты сохранены в workflow-plan.md и в память
- Возврат к вызывающему шагу выполнен корректно

### ПРОВАЛ:
- Пропуск идентификации противоречия
- Генерация решений без участия пользователя
- Невозврат к вызывающему шагу
- Отсутствие документирования результатов

**Главное правило:** TRIZ разрешает противоречия, а не создаёт компромиссы. Фокус на ИКР.

---

**Конец Шага 4.5**

Возврат к: [Шаг 4: Консилиум](./step-04-consilium.md) | [Шаг 5: Скоринг](./step-05-scoring.md) | [Шаг 8: Deep Plan](./step-08-deep-plan.md)
